
nnoremap <silent><localleader>b :call  RunPython() <CR>
function! RunPython()
    let g:console_load = term_getstatus('ipython')
    if g:console_load == 'running' 
        call term_sendkeys('ipython','run '. expand('%') . "\<CR>") 
    endif
    if g:console_load != 'running'
        "exec ":term ++close ++hidden ipython"
        exec "!python " . expand('%')
    endif
endfunction
